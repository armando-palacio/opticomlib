

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>opticomlib.typing &mdash; opticomlib  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/fonts.css" />

  
    <link rel="shortcut icon" href="../../_static/favicon_laser.ico"/>
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
      <script src="../../_static/clipboard.min.js"></script>
      <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            opticomlib
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html#usage">Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OptiComLib Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../types.html">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devices.html">Electro-Optical Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ook.html">OOK Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ppm.html">PPM Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lab.html">Laboratory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">Utilities functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">opticomlib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">opticomlib.typing</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for opticomlib.typing</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. rubric:: Classes</span>
<span class="sd">.. autosummary::</span>

<span class="sd">    global_variables</span>
<span class="sd">    binary_sequence</span>
<span class="sd">    electrical_signal</span>
<span class="sd">    optical_signal</span>
<span class="sd">    eye</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span><span class="p">,</span> <span class="n">fftfreq</span><span class="p">,</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">ifftshift</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pympler.asizeof</span><span class="w"> </span><span class="kn">import</span> <span class="n">asizeof</span> <span class="k">as</span> <span class="n">sizeof</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">c</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">expit</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sg</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">LineCollection</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Iterable</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">str2array</span><span class="p">,</span> 
    <span class="n">dbm</span><span class="p">,</span> 
    <span class="n">si</span><span class="p">,</span> 
    <span class="n">upfir</span><span class="p">,</span>
    <span class="n">eyediagram</span><span class="p">,</span>
    <span class="n">ComplexNumber</span><span class="p">,</span>
    <span class="n">RealNumber</span><span class="p">,</span>
    <span class="n">IntegerNumber</span><span class="p">,</span>
    <span class="n">tic</span><span class="p">,</span> <span class="n">toc</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">logging</span><span class="p">,</span> <span class="n">HierLogger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">HierLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">INFO</span><span class="p">,</span> <span class="n">DEBUG</span><span class="p">,</span> <span class="n">WARNING</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>

<span class="n">Array_Like</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>











<span class="k">class</span><span class="w"> </span><span class="nc">NULLType</span><span class="p">:</span> 
    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># n + null -&gt; n</span>
        <span class="k">return</span> <span class="n">other</span>
    <span class="fm">__radd__</span> <span class="o">=</span> <span class="fm">__add__</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># n * null -&gt; 0</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;NULL&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;NULL&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">other</span>
    <span class="fm">__rsub__</span> <span class="o">=</span> <span class="fm">__add__</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="fm">__floordiv__</span> <span class="o">=</span> <span class="fm">__truediv__</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__array_function__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;__call__&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span> <span class="ow">or</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">return</span> <span class="n">lhs</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># Return self so that any attribute access returns NULL</span>
        <span class="c1"># This also allows chaining: NULL.real.imag -&gt; NULL</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Return self so that any method call returns NULL</span>
        <span class="c1"># This handles cases like NULL.conj() -&gt; NULL</span>
        <span class="k">return</span> <span class="bp">self</span>
<span class="n">NULL</span> <span class="o">=</span> <span class="n">NULLType</span><span class="p">()</span>











<div class="viewcode-block" id="global_variables"><a class="viewcode-back" href="../../types.html#opticomlib.typing.global_variables">[docs]</a><span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent_methods</span>
<span class="k">class</span><span class="w"> </span><span class="nc">global_variables</span><span class="p">():</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;**Global Variables (gv)**</span>

<span class="sd">    This object stores the simulation-wide parameters required across the pipeline.</span>
<span class="sd">    It keeps track of the sampling frequency, slot rate, samples per slot, number of</span>
<span class="sd">    simulated slots, optical wavelength/frequency, preferred plotting style, and logging verbosity.</span>

<span class="sd">    .. Note:: </span>
<span class="sd">        </span>
<span class="sd">        A slot is taken as the smallest time unit representing a binary value of the signal.</span>
<span class="sd">        For example, in PPM a bit is not the same as a slot. However, in OOK a bit and a slot are the same.</span>

<span class="sd">    This class doesn&#39;t need to be instantiated; it is already exposed as ``gv``.</span>
<span class="sd">    Use the :meth:`__call__` method (e.g. ``gv(**kwargs)``) to refresh parameters,</span>
<span class="sd">    update Matplotlib&#39;s style via ``plt_style`` or adjust the logger through ``verbose``.</span>
<span class="sd">    </span>
<span class="sd">    .. rubric:: Attributes</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        ~global_variables.sps</span>
<span class="sd">        ~global_variables.R</span>
<span class="sd">        ~global_variables.fs</span>
<span class="sd">        ~global_variables.wavelength</span>
<span class="sd">        ~global_variables.f0</span>
<span class="sd">        ~global_variables.N</span>
<span class="sd">        ~global_variables.dt</span>
<span class="sd">        ~global_variables.t</span>
<span class="sd">        ~global_variables.dw</span>
<span class="sd">        ~global_variables.w</span>
<span class="sd">        ~global_variables.plt_style</span>
<span class="sd">        ~global_variables.verbose</span>

<span class="sd">        </span>
<span class="sd">    .. rubric:: Methods</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        __call__</span>
<span class="sd">        print</span>
<span class="sd">        default</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; gv(R=10e9, sps=8, N=100).print()</span>

<span class="sd">    ::</span>

<span class="sd">        ------------------------------</span>
<span class="sd">        ***    Global Variables    ***</span>
<span class="sd">        ------------------------------</span>
<span class="sd">                sps :  8</span>
<span class="sd">                R   :  1.00e+10</span>
<span class="sd">                fs  :  8.00e+10</span>
<span class="sd">                λ0  :  1.55e-06</span>
<span class="sd">                f0  :  1.93e+14</span>
<span class="sd">                N   :  100</span>
<span class="sd">                dt  :  1.25e-11</span>
<span class="sd">                t   :  [0.00e+00 1.25e-11 2.50e-11 ... 9.97e-09 9.99e-09 1.00e-08]</span>
<span class="sd">                dw  :  6.28e+08</span>
<span class="sd">        Config</span>
<span class="sd">        ------</span>
<span class="sd">                plt_style :  &quot;fast&quot;</span>
<span class="sd">                verbose   :  None</span>

<span class="sd">    Also can be define new variables trough \*\*kwargs. If at least two of this arguments (``sps``, ``fs`` and ``R``) are not provided</span>
<span class="sd">    a warning will be raised and the default values will be used.</span>

<span class="sd">    &gt;&gt;&gt; gv(alpha=0.5, beta=0.3).print()</span>
<span class="sd">    </span>
<span class="sd">    ::</span>

<span class="sd">        ------------------------------</span>
<span class="sd">        ***    Global Variables    ***</span>
<span class="sd">        ------------------------------</span>
<span class="sd">                sps :  16</span>
<span class="sd">                R   :  1.00e+09</span>
<span class="sd">                fs  :  1.60e+10</span>
<span class="sd">                λ0  :  1.55e-06</span>
<span class="sd">                f0  :  1.93e+14</span>
<span class="sd">                N   :  128</span>
<span class="sd">                dt  :  6.25e-11</span>
<span class="sd">                t   :  [0.00e+00 6.25e-11 1.25e-10 ... 1.28e-07 1.28e-07 1.28e-07]</span>
<span class="sd">                dw  :  4.91e+07</span>
<span class="sd">        Config</span>
<span class="sd">        ------</span>
<span class="sd">                plt_style :  &quot;fast&quot;</span>
<span class="sd">                verbose   :  None</span>
<span class="sd">        Custom</span>
<span class="sd">        ------</span>
<span class="sd">                alpha : 0.5</span>
<span class="sd">                beta : 0.3</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sps</span> <span class="o">=</span> <span class="mi">16</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of samples per slot, ``16`` by default.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mf">1e9</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Slot rate in Hz, ``1e9`` by default.&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sampling frequency in Samples/s, ``R*sps=16e9`` by default.&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time step in seconds, ``1/fs=62.5e-12`` by default.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1550e-9</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optical communication central wavelength in meters, ``1550e-9`` by default.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f0</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optical communication central frequency in Hz, ``c/wavelength=193.4e12`` by default.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="mi">128</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of slots to simulate (128 by default).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time array in seconds&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dw</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Frequency step in rad/s&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fftshift</span><span class="p">(</span><span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Frequency array in rad/s&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span> <span class="o">=</span> <span class="s1">&#39;fast&#39;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Matplotlib plot style, ``&quot;fast&quot;`` by default.&quot;&quot;&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logging verbosity level, ``None`` by default. Can be set to ``DEBUG`` or 10, ``INFO`` or 20, ``WARNING`` or 30.&quot;&quot;&quot;</span>

            
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">title</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="s1">&#39;    Global Variables    &#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39;-&#39;</span>

        <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sps&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">,</span> <span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;dw&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;plt_style&#39;</span><span class="p">,</span> <span class="s1">&#39;verbose&#39;</span><span class="p">]]</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;sps :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;R   :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;fs  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;λ0  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;f0  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">f0</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;N   :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;dt  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;t   :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;dw  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dw</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;  Config</span><span class="se">\n</span><span class="s1">  ------</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;plt_style :  &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;verbose   :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
            
        <span class="k">if</span> <span class="n">others</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  Custom</span><span class="se">\n</span><span class="s1">  ------</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">others</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">msg</span>
    
<div class="viewcode-block" id="global_variables.print"><a class="viewcode-back" href="../../types.html#opticomlib.typing.global_variables.print">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Prints the global variables in a formatted manner&quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="global_variables.__call__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.global_variables.__call__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> 
            <span class="n">sps</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">R</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">fs</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">wavelength</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1550e-9</span><span class="p">,</span> 
            <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">plt_style</span> <span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ggplot&#39;</span><span class="p">,</span> <span class="s1">&#39;bmh&#39;</span><span class="p">,</span> <span class="s1">&#39;dark_background&#39;</span><span class="p">,</span> <span class="s1">&#39;fast&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;fast&#39;</span><span class="p">,</span> 
            <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kargs</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the instance with the provided parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sps : int, optional</span>
<span class="sd">            Samples per slot.</span>
<span class="sd">        R : float, optional</span>
<span class="sd">            Rate in Hz.</span>
<span class="sd">        fs : float, optional</span>
<span class="sd">            Sampling frequency in Samples/s.</span>
<span class="sd">        wavelength : float, optional</span>
<span class="sd">            Wavelength in meters. Default is 1550e-9.</span>
<span class="sd">        N : int, optional</span>
<span class="sd">            Number of samples.</span>
<span class="sd">        plt_style : str, optional</span>
<span class="sd">            Matplotlib plot style. Default is &quot;fast&quot;.</span>
<span class="sd">        verbose : int | None, optional</span>
<span class="sd">            Verbosity level for logging.</span>
<span class="sd">        **kargs : dict</span>
<span class="sd">            Additional custom parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gv</span>
<span class="sd">            The instance itself.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        In the absence of parameters, default values are used. Missing parameters are calculated from the provided ones, prioritizing the default value of **gv.R** when more than one of **sps**, **fs**, and **R** is not provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;setting gv()&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sps</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">R</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>
            <span class="k">elif</span> <span class="n">fs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">fs</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;&#39;R&#39; set to default value (</span><span class="si">%.2e</span><span class="s2"> bits/s)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>

        <span class="k">elif</span> <span class="n">R</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
            <span class="k">if</span> <span class="n">fs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">fs</span><span class="o">/</span><span class="n">R</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;&#39;sps&#39; set to default value (</span><span class="si">%d</span><span class="s2"> S/bit)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>

        <span class="k">elif</span> <span class="n">fs</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;&#39;R&#39; set to default value (</span><span class="si">%.2e</span><span class="s2"> bits/s)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">fs</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;&#39;sps&#39;, &#39;R&#39; and &#39;fs&#39; will be set to default values (</span><span class="si">%d</span><span class="s2"> S/bit, </span><span class="si">%.2e</span><span class="s2"> bits/s, </span><span class="si">%.2e</span><span class="s2"> Hz)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span> <span class="k">if</span> <span class="n">N</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_t_dw_w</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f0</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="n">wavelength</span>

        <span class="k">if</span> <span class="n">plt_style</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span> <span class="o">=</span> <span class="n">plt_style</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Global variables set to, sps: </span><span class="si">%d</span><span class="s1">, R: </span><span class="si">%.2e</span><span class="s1">, fs: </span><span class="si">%.2e</span><span class="s1">, N: </span><span class="si">%d</span><span class="s1">, wavelength: </span><span class="si">%.2e</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_t_dw_w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dw</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fftshift</span><span class="p">(</span><span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span>

<div class="viewcode-block" id="global_variables.default"><a class="viewcode-back" href="../../types.html#opticomlib.typing.global_variables.default">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return all parameters to default values.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;resetting gv to default()&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sps</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mf">1e9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1550e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f0</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="mi">128</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_t_dw_w</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span> <span class="o">=</span> <span class="s1">&#39;fast&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Reset logger level to default (NOTSET allows propagation to parent)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">gv</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">gv</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sps&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">,</span> <span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;dw&#39;</span><span class="p">,</span> <span class="s1">&#39;plt_style&#39;</span><span class="p">,</span> <span class="s1">&#39;verbose&#39;</span><span class="p">])]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Global variables set to default, sps: </span><span class="si">%d</span><span class="s1">, R: </span><span class="si">%.2e</span><span class="s1">, fs: </span><span class="si">%.2e</span><span class="s1">, N: </span><span class="si">%d</span><span class="s1">, wavelength: </span><span class="si">%.2e</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>

<span class="n">gv</span> <span class="o">=</span> <span class="n">global_variables</span><span class="p">()</span>












<div class="viewcode-block" id="binary_sequence"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence">[docs]</a><span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent_methods</span>
<span class="k">class</span><span class="w"> </span><span class="nc">binary_sequence</span><span class="p">():</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;**Binary Sequence**</span>

<span class="sd">    This class provides methods and attributes to work with binary sequences. </span>
<span class="sd">    The binary sequence can be provided as a string, list, tuple, or numpy array.</span>

<span class="sd">    .. rubric:: Attributes</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        ~binary_sequence.data</span>
<span class="sd">        ~binary_sequence.execution_time</span>
<span class="sd">        ~binary_sequence.ones</span>
<span class="sd">        ~binary_sequence.zeros</span>
<span class="sd">        ~binary_sequence.size</span>
<span class="sd">        ~binary_sequence.type</span>
<span class="sd">        ~binary_sequence.sizeof</span>

<span class="sd">    .. rubric:: Methods</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        prbs</span>
<span class="sd">        print</span>
<span class="sd">        to_numpy</span>
<span class="sd">        flip</span>
<span class="sd">        hamming_distance</span>
<span class="sd">        dac</span>
<span class="sd">        plot</span>

<span class="sd">    .. table:: **Implemented Operators**</span>
<span class="sd">        :widths: 10 90</span>
<span class="sd">        :align: center</span>

<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | Operator                       | Description                                                  |</span>
<span class="sd">        +================================+==============================================================+</span>
<span class="sd">        | ``~``                          | ``~a`` NOT operation, bit by bit.                            |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``&amp;``                          | ``a &amp; b`` AND operation, bit by bit                          |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``|``                          | ``a | b`` OR operation, bit by bit                           |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``^``                          | ``a ^ b`` XOR operation, bit by bit                          |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``+``                          | ``a + b`` concatenate ``a ∪ b``; ``b + a`` concatenate       |</span>
<span class="sd">        |                                | ``b ∪ a``.                                                   |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``*``                          | ``a * n`` (n &gt; 1 integer) repeats ``a`` n times; ``a * b``   |</span>
<span class="sd">        |                                | equivalent to ``&amp;`` operator.                                |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``==``                         | ``a == b`` compares elements, returning a ``binary_sequence``|</span>
<span class="sd">        |                                | mask of matches.                                             |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``!=``                         | ``a != b`` compares elements, returning a ``binary_sequence``|</span>
<span class="sd">        |                                | mask of differences.                                         |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``[:]``                        | ``a[i]`` returns the integer value at index ``i``;           |</span>
<span class="sd">        |                                | ``a[i:j]`` returns a sliced ``binary_sequence``.             |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">        | ``&lt;``, ``&lt;=``, ``&gt;``, ``&gt;=``   | Not implemented                                              |</span>
<span class="sd">        | ``-``, ``/``, ``//``, ``&lt;&lt;``,  |                                                              |</span>
<span class="sd">        | ``&gt;&gt;``,                        |                                                              |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.__init__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">str2array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)):</span> 
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The array must contain only 0&#39;s and 1&#39;s!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binary sequence must be 1D array, invalid shape </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The binary sequence data, a 1D numpy array of boolean values.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The execution time of the last operation performed on the binary sequence.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__str__()&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">    &#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39;-&#39;</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;data  :  </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1"> (shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">)</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;ones  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ones</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;zeros :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">zeros</span><span class="si">}</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;size  :  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sizeof</span><span class="si">}</span><span class="s1"> bytes</span><span class="se">\n\t</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;time  :  </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">msg</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__repr__()&#39;</span><span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;binary_sequence(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__len__()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
    
<div class="viewcode-block" id="binary_sequence.__array__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.__array__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the array representation of the binary sequence.</span>
<span class="sd">        </span>
<span class="sd">        This method provides the basic array conversion for NumPy compatibility.</span>
<span class="sd">        It returns the data.</span>
<span class="sd">        This is the fundamental protocol that allows the object to be converted to a NumPy array</span>
<span class="sd">        when needed, enabling direct use in NumPy functions that expect array-like objects.</span>
<span class="sd">        </span>
<span class="sd">        Unlike ``__array_ufunc__`` and ``__array_function__``, this method is called for basic array</span>
<span class="sd">        conversion and does not handle specific NumPy operations - it simply provides the</span>
<span class="sd">        underlying data as an array.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dtype : np.dtype, optional</span>
<span class="sd">            Desired data type of the array.</span>
<span class="sd">                </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The array representation of the binary data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__array__()&#39;</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">return</span> <span class="n">arr</span></div>
    
<div class="viewcode-block" id="binary_sequence.__getattr__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.__getattr__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegate attribute access to the underlying NumPy array for array-like methods.</span>
<span class="sd">        </span>
<span class="sd">        This method allows instances of ``binary_sequence`` to access NumPy array methods</span>
<span class="sd">        (like max, min, sum, etc.) directly as if they were arrays. If the requested attribute</span>
<span class="sd">        is a method or property of np.ndarray, it will be called on the array representation</span>
<span class="sd">        of this object.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the attribute being accessed.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result</span>
<span class="sd">            The result of calling the attribute on the array representation.</span>
<span class="sd">            </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            If the attribute is not found in np.ndarray.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__getattr__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="c1"># Check if the attribute exists in np.ndarray and is not a private/internal attribute</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Delegating attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; to ndarray for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__array__</span><span class="p">(),</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="binary_sequence.__array_ufunc__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.__array_ufunc__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle NumPy universal functions (ufuncs) by converting the object to an array.</span>
<span class="sd">        </span>
<span class="sd">        This method is specifically designed for NumPy&#39;s universal functions, which are</span>
<span class="sd">        element-wise operations like np.add, np.sin, np.multiply, etc. When a ufunc is</span>
<span class="sd">        called on an instance of this class, this method intercepts the call, converts</span>
<span class="sd">        any instances of this class in the inputs to arrays using ``__array__()``, and then</span>
<span class="sd">        applies the ufunc to the converted arrays.</span>
<span class="sd">        </span>
<span class="sd">        Unlike ``__array__``, which provides basic array conversion, this method handles</span>
<span class="sd">        the execution of specific ufunc operations. Unlike ``__array_function__``, which</span>
<span class="sd">        handles higher-level array functions, this focuses on element-wise operations.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ufunc : numpy.ufunc</span>
<span class="sd">            The NumPy universal function being called.</span>
<span class="sd">        method : str</span>
<span class="sd">            The method of the ufunc (e.g., &#39;__call__&#39;, &#39;reduce&#39;).</span>
<span class="sd">        *inputs : tuple</span>
<span class="sd">            The input arguments to the ufunc.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments passed to the ufunc.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result</span>
<span class="sd">            The result of applying the ufunc to the converted inputs, wrapped in the</span>
<span class="sd">            appropriate class if the result is an array with compatible shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__array_ufunc__(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">ufunc</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;__call__&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">rhs</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">rhs</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
        
        <span class="c1"># Convert inputs that are instances of this class to arrays</span>
        <span class="n">new_inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="n">new_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">__array__</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">new_inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Failed to convert ufunc result to binary_sequence: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>
    
<div class="viewcode-block" id="binary_sequence.__array_function__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.__array_function__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">__array_function__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle NumPy array functions by converting the object to an array.</span>
<span class="sd">        </span>
<span class="sd">        This method is called for NumPy array functions that are not universal functions (ufuncs).</span>
<span class="sd">        It handles higher-level array operations like np.sum, np.mean, np.concatenate, np.fft.fft,</span>
<span class="sd">        and other array manipulation functions. When such a function is called on an instance of</span>
<span class="sd">        this class, this method converts any instances in the arguments to arrays and then calls</span>
<span class="sd">        the function with the converted arguments.</span>
<span class="sd">        </span>
<span class="sd">        Key differences from other protocols:</span>

<span class="sd">        - ``__array__``: Provides basic array conversion without handling specific operations.</span>
<span class="sd">        - ``__array_ufunc__``: Handles element-wise universal functions (ufuncs) like np.add, np.sin, etc.</span>
<span class="sd">        - ``__array_function__``: Handles higher-level array functions and transformations like np.abs, etc.</span>
<span class="sd">        </span>
<span class="sd">        This enables seamless integration with NumPy&#39;s array function ecosystem, allowing</span>
<span class="sd">        instances to be used directly in functions like np.sum(x), np.mean(x), np.concatenate([x, y]),</span>
<span class="sd">        etc., without manual conversion.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : callable</span>
<span class="sd">            The NumPy array function being called (e.g., np.sum, np.mean).</span>
<span class="sd">        types : tuple</span>
<span class="sd">            The types of all arguments passed to the function.</span>
<span class="sd">        args : tuple</span>
<span class="sd">            The positional arguments passed to the function.</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            The keyword arguments passed to the function.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result</span>
<span class="sd">            The result of applying the NumPy array function to the converted arguments, wrapped in the</span>
<span class="sd">            appropriate class if the result is an array with compatible shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__array_function__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_convert</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__array__</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)(</span><span class="n">_convert</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">_convert</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">obj</span>
        
        <span class="c1"># Convert args and kwargs that contain instances to arrays</span>
        <span class="n">new_args</span> <span class="o">=</span> <span class="n">_convert</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="n">_convert</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">new_args</span><span class="p">,</span> <span class="o">**</span><span class="n">new_kwargs</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Failed to convert array_function result to binary_sequence: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="binary_sequence.__getitem__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.__getitem__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">slice</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a slice of the binary sequence (``self[slice]``). </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        slice : :obj:`int` or :obj:`slice`</span>
<span class="sd">            The slice to get. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`int` or :obj:`binary_sequence`</span>
<span class="sd">            The value of the slot if `slice` is an integer, or a new binary sequence object with the result of the slice.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__getitem__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">])</span></div>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__eq__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__ne__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__add__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__radd__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__mul__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Repeat the sequence other times</span>
            <span class="n">repeated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert other to binary_sequence if necessary</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span>
            <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__invert__()&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__or__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">|</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="fm">__ror__</span> <span class="o">=</span> <span class="fm">__or__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__and__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">&amp;</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="fm">__rand__</span> <span class="o">=</span> <span class="fm">__and__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;__xor__(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="fm">__rxor__</span> <span class="o">=</span> <span class="fm">__xor__</span>
    
    <span class="c1"># properties</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of ones in the binary sequence.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;ones: </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of zeros in the binary sequence.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;zeros: </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of slots of the binary sequence.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;size: </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Object type.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;type: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Memory size of object in bytes.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;sizeof&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;sizeof: </span><span class="si">%d</span><span class="s1"> bytes&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    
    <span class="c1"># static methods</span>
<div class="viewcode-block" id="binary_sequence.prbs"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.prbs">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prbs</span><span class="p">(</span>
        <span class="n">order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
        <span class="nb">len</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
        <span class="n">return_seed</span><span class="p">:</span> 
        <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Pseudorandom binary sequence generator (PRBS) (*static method*).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : :obj:`int`, {7, 9, 11, 15, 20, 23, 31}</span>
<span class="sd">            degree of the generating pseudorandom polynomial</span>
<span class="sd">        len : :obj:`int`, optional</span>
<span class="sd">            lenght of output binary sequence</span>
<span class="sd">        seed : :obj:`int`, optional</span>
<span class="sd">            seed of the generator (initial state of the LFSR).</span>
<span class="sd">            It must be provided if you want to continue the sequence.</span>
<span class="sd">            Default is 2**order-1.</span>
<span class="sd">        return_seed : :obj:`bool`, optional</span>
<span class="sd">            If True, the last state of LFSR is returned. Default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out : :obj:`binary_sequence`</span>
<span class="sd">            generated pseudorandom binary sequence if `return_seed` is False</span>
<span class="sd">        out, last_seed : :obj:`tuple` of (:obj:`binary_sequence`, : obj:`int`)</span>
<span class="sd">            generated pseudorandom binary sequence and last state of LFSR if `return_seed`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tic</span><span class="p">()</span>
        <span class="n">taps</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="mi">11</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
            <span class="mi">15</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
            <span class="mi">20</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="mi">23</span><span class="p">:</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span>
            <span class="mi">31</span><span class="p">:</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">order</span><span class="p">)</span> <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">order</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The seed can&#39;t be 0 or a multiple of 2**order. It has been changed to 1.&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The parameter `len` must be an integer.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The parameter `len` must be an integer greater than cero.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">len</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">order</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The parameter `order` must be one of the following values (7, 9, 11, 15, 20, 23, 31).&quot;</span>
            <span class="p">)</span>

        <span class="n">prbs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>  <span class="c1"># Preallocate memory for the PRBS</span>
        <span class="n">lfsr</span> <span class="o">=</span> <span class="n">seed</span>  <span class="c1"># initial state of the LFSR</span>
        <span class="n">tap1</span><span class="p">,</span> <span class="n">tap2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">taps</span><span class="p">[</span><span class="n">order</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">:</span>
            <span class="n">prbs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">lfsr</span> <span class="o">&amp;</span> <span class="mi">1</span>
            <span class="n">new</span> <span class="o">=</span> <span class="p">((</span><span class="n">lfsr</span> <span class="o">&gt;&gt;</span> <span class="n">tap1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">lfsr</span> <span class="o">&gt;&gt;</span> <span class="n">tap2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span>
            <span class="n">lfsr</span> <span class="o">=</span> <span class="p">((</span><span class="n">lfsr</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">new</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">order</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">prbs</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="n">toc</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_seed</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">lfsr</span></div>

    <span class="c1"># methods</span>
<div class="viewcode-block" id="binary_sequence.print"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.print">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print object parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        msg : str, opcional</span>
<span class="sd">            top message to show</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`binary_sequence`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;print()&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="binary_sequence.to_numpy"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.to_numpy">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a NumPy representation of the binary sequence. This method is similar to ``__array__``, the diference is that some libraries, as matplotlib, used to call this method to get the numpy array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;to_numpy(dtype=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="binary_sequence.flip"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.flip">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Invert the binary sequence. Equivalent to the ``~`` operator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        binary_sequence</span>
<span class="sd">            A new binary sequence object with the result of the inversion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;flip()&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">~</span><span class="bp">self</span></div>

<div class="viewcode-block" id="binary_sequence.hamming_distance"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.hamming_distance">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">hamming_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the Hamming distance to another binary sequence of the same length.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : :obj:`str` or :obj:`binary_sequence` or :obj:`Array_Like`</span>
<span class="sd">            The binary sequence to compare.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`int`</span>
<span class="sd">            The Hamming distance between the two binary sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;hamming_distance(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">binary_sequence</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span> <span class="o">!=</span> <span class="n">other</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="binary_sequence.dac"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.dac">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">dac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply upsampling and FIR filtering to the binary sequence for digital-to-analog conversion.</span>

<span class="sd">        This method upsamples the binary sequence by the global samples per slot (gv.sps) and applies the provided FIR filter to produce an electrical signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h : :obj:`np.ndarray`</span>
<span class="sd">            The FIR filter impulse response to use for shaping the signal.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            The resulting electrical signal after upsampling, filtering, and downsampling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;dac()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">electrical_signal</span><span class="p">(</span><span class="n">upfir</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">up</span><span class="o">=</span><span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="binary_sequence.plot"><a class="viewcode-back" href="../../types.html#opticomlib.typing.binary_sequence.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the binary sequence using matplotlib.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : :obj:`dict`</span>
<span class="sd">            Additional keyword arguments to customize the plot.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`matplotlib.axes.Axes`</span>
<span class="sd">            The axes object of the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;plot()&#39;</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Binary Sequence&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div></div>











<div class="viewcode-block" id="electrical_signal"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal">[docs]</a><span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent_methods</span>
<span class="k">class</span><span class="w"> </span><span class="nc">electrical_signal</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;**Electrical Signal**</span>

<span class="sd">    This class provides methods and attributes to work with electrical signals. </span>
<span class="sd">    It has overloaded operators necessary to properly interpret </span>
<span class="sd">    the ``+``, ``-``, ``*``, ``/``, ``**``, and comparison operations as any numpy array.</span>

<span class="sd">    .. rubric:: Attributes</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        ~electrical_signal.signal</span>
<span class="sd">        ~electrical_signal.noise</span>
<span class="sd">        ~electrical_signal.execution_time</span>
<span class="sd">        ~electrical_signal.size</span>
<span class="sd">        ~electrical_signal.real</span>
<span class="sd">        ~electrical_signal.imag</span>
<span class="sd">        ~electrical_signal.type</span>
<span class="sd">        ~electrical_signal.fs</span>
<span class="sd">        ~electrical_signal.sps</span>
<span class="sd">        ~electrical_signal.dt</span>
<span class="sd">        ~electrical_signal.t</span>
<span class="sd">        ~electrical_signal.sizeof</span>

<span class="sd">    .. rubric:: Methods</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        __init__</span>
<span class="sd">        __call__</span>
<span class="sd">        print</span>
<span class="sd">        to_numpy</span>
<span class="sd">        conj</span>
<span class="sd">        sum</span>
<span class="sd">        w</span>
<span class="sd">        f</span>
<span class="sd">        abs</span>
<span class="sd">        power</span>
<span class="sd">        normalize</span>
<span class="sd">        phase</span>
<span class="sd">        filter</span>
<span class="sd">        plot</span>
<span class="sd">        psd</span>
<span class="sd">        plot_eye</span>
<span class="sd">        grid</span>
<span class="sd">        legend</span>
<span class="sd">        show</span>

<span class="sd">    .. table:: **Implemented Operators**</span>
<span class="sd">        :widths: 10 90</span>
<span class="sd">        :align: center</span>

<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | Operator                       | Description                                                                                      |</span>
<span class="sd">        +================================+==================================================================================================+</span>
<span class="sd">        | ``+``                          | ``a + b`` adds signals and noises element-wise;                                                  |</span>
<span class="sd">        |                                | ``sig = (a.signal + b.signal), noi = (a.noise + b.noise)``                                       |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``-``                          | ``a - b`` subtracts signals and noises element-wise;                                             |</span>
<span class="sd">        |                                | ``sig = (a.signal - b.signal), noi = (a.noise - b.noise)``                                       |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``*``                          | ``a * b`` multiplies two ``electrical_signal``;                                                  |</span>
<span class="sd">        |                                | ``sig = (a.signal*b.signal)``                                                                    |</span>
<span class="sd">        |                                | ``noi = (a.signal*b.noise + a.noise*b.signal + a.noise*b.noise)``                                |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``/``                          | ``a / n`` divides signal and noise by a scalar;                                                  |</span>
<span class="sd">        |                                | ``sig = (a.signal/n), noi = (a.signal/n)``                                                       |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``//``                         | ``a // n`` floor divides signal and noise by a scalar;                                           |</span>
<span class="sd">        |                                | ``sig = (a.signal//n), noi = (a.signal//n)``                                                     |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``**``                         | ``a ** n`` raises ``electrical_signal`` to a power;                                              |</span>
<span class="sd">        |                                | ``- n=1  --&gt;  sig = (a.signal), noi = (a.noise)``;                                               |</span>
<span class="sd">        |                                | ``- n=2  --&gt;  sig = (a.signal**2), noi = (2*a.signal*a.noise + a.noise**2)``                     |</span>
<span class="sd">        |                                | ``- n=other  --&gt;  sig = (a.signal + a.noise)**n, noi=NULL``                                      |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``&gt;``                          | ``a &gt; b`` compares signals element-wise, returns                                                 |</span>
<span class="sd">        |                                | ``binary_sequence`` mask.                                                                        |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``&lt;``                          | ``a &lt; b`` compares signals element-wise, returns                                                 |</span>
<span class="sd">        |                                | ``binary_sequence`` mask.                                                                        |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``==``                         | ``a == b`` compares signals element-wise, returns                                                |</span>
<span class="sd">        |                                | ``np.ndarray`` mask.                                                                             |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``[:]``                        | ``a[i]`` returns the value at index ``i``;                                                       |</span>
<span class="sd">        |                                | ``a[i:j]`` returns a sliced ``electrical_signal``.                                               |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">        | ``-`` (unary)                  | ``-a`` negates signal and noise.                                                                 |</span>
<span class="sd">        +--------------------------------+--------------------------------------------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="electrical_signal.__init__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.__init__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initialize the electrical signal object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        signal : :obj:`str` or 1D array_like or scalar</span>
<span class="sd">            The signal values.</span>
<span class="sd">        noise : :obj:`str` or 1D array_like or scalar, optional</span>
<span class="sd">            The noise values. Defaults to ``NULL``.</span>
<span class="sd">        dtype : :obj:`np.dtype`, optional</span>
<span class="sd">            The desired data type for the signal and noise arrays. If not provided, the data type</span>
<span class="sd">            will be inferred from the input data. Defaults to ``None``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The signal and noise can be provided as a string, in which case it will be converted to a </span>
<span class="sd">        ``numpy.array`` using the :func:`str2array` function. For example:</span>
<span class="sd">        </span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            &gt;&gt;&gt; electrical_signal(&#39;1 2 3,4,5&#39;)  # separate values by space or comma indistinctly</span>
<span class="sd">            electrical_signal(signal=[1 2 3 4 5],</span>
<span class="sd">                               noise=NULL)</span>
<span class="sd">            &gt;&gt;&gt; electrical_signal(&#39;1+2j, 3+4j, 5+6j&#39;) # complex values</span>
<span class="sd">            electrical_signal(signal=[1.+2.j 3.+4.j 5.+6.j],</span>
<span class="sd">                               noise=NULL)</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="n">sig</span><span class="p">,</span> <span class="n">noi</span> <span class="o">=</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">electrical_signal</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.__init__()&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">electrical_signal</span><span class="p">):</span>
                <span class="n">sig</span><span class="p">,</span> <span class="n">noi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">noise</span>
                <span class="k">if</span> <span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">noi_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_arrays</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span> <span class="o">+</span> <span class="n">noi_</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sig</span><span class="p">,</span> <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_arrays</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">sig</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal must be scalar or 1D array for electrical_signal, invalid shape </span><span class="si">{</span><span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">sig</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The signal values, a 1D array-like values.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noi</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The noise values, a 1D array-like values.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The execution time of the last operation performed.&quot;&quot;&quot;</span></div>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__str__()&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">    &#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39;-&#39;</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39; &#39;</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">tab</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">tab</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

        <span class="n">pw_sig_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">)</span>
        <span class="n">pw_sig_dbm</span> <span class="o">=</span> <span class="n">dbm</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">)</span>

        <span class="n">pw_noi_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">)</span>
        <span class="n">pw_noi_dbm</span> <span class="o">=</span> <span class="n">dbm</span><span class="p">(</span><span class="n">pw_noi_w</span><span class="p">)</span>

        <span class="n">pw_all_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
        <span class="n">pw_all_dbm</span> <span class="o">=</span> <span class="n">dbm</span><span class="p">(</span><span class="n">pw_all_w</span><span class="p">)</span> 
        
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;signal:     </span><span class="si">{</span><span class="n">signal</span><span class="si">}</span><span class="s1"> (shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;noise:      </span><span class="si">{</span><span class="n">noise</span><span class="si">}</span><span class="s1"> (shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s2">&quot;pow_signal: </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_sig_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s2">&quot;pow_noise:  </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_noi_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_noi_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s2">&quot;pow_total:  </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_all_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_all_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;len:        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;elem_type:  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;mem_size:   </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sizeof</span><span class="si">}</span><span class="s1"> bytes</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;time:       </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">msg</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__repr__()&quot;</span><span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;electrical_signal(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;electrical_signal(signal=</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="si">}</span><span class="s1">,</span><span class="se">\n\t\t</span><span class="s1">   noise=</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__len__()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__iter__()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__array__</span><span class="p">())</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__array__()&quot;</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arr</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__getattr__(&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="c1"># Check if the attribute exists in np.ndarray and is not a private/internal attribute</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Delegating attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; to ndarray for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__array__</span><span class="p">(),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; not found in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__array_ufunc__(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">),</span> <span class="n">method</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;__call__&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">electrical_signal</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">rhs</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">electrical_signal</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">rhs</span><span class="p">)</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ufunc</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">:</span>
                <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">inputs</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">electrical_signal</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">rhs</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>

        <span class="c1"># Convert inputs that are instances of this class to arrays</span>
        <span class="n">new_inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="n">new_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">__array__</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="c1"># Call the ufunc</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">new_inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># If the result is an array with compatible shape, wrap it in the class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">electrical_signal</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">optical_signal</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__array_function__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__array_function__(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_convert</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;_convert(</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__array__</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)(</span><span class="n">_convert</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">_convert</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">obj</span>
        
        <span class="c1"># Convert args and kwargs that contain instances to arrays</span>
        <span class="n">new_args</span> <span class="o">=</span> <span class="n">_convert</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="n">_convert</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">new_args</span><span class="p">,</span> <span class="o">**</span><span class="n">new_kwargs</span><span class="p">)</span>
        
        <span class="c1"># If the result is an array with compatible shape, wrap it in the class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">electrical_signal</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">optical_signal</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__add__()&quot;</span><span class="p">)</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">signal</span>
        <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">noise</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__radd__()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__neg__()&quot;</span><span class="p">)</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span>
        <span class="n">noi</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__sub__()&quot;</span><span class="p">)</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__rsub__()&quot;</span><span class="p">)</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__mul__()&quot;</span><span class="p">)</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">signal</span>
        <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">noise</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">noise</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__rmul__()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__truediv__()&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">ComplexNumber</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Division by unsupported type </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t divide electrical_signal by type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Attempted division by zero in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t divide electrical_signal by zero&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">/</span> <span class="n">number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">/</span> <span class="n">number</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__floordiv__()&quot;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">/</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span> <span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__getitem__(</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="n">NULL</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="n">NULL</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid argument type. </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__gt__()&quot;</span><span class="p">)</span> 
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        
        <span class="n">x_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span>
        <span class="n">x_l</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">noise</span>

        <span class="k">return</span> <span class="n">binary_sequence</span><span class="p">(</span><span class="n">x_r</span> <span class="o">&gt;</span> <span class="n">x_l</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__lt__()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">other</span> <span class="o">-</span> <span class="bp">self</span> <span class="o">&gt;</span> <span class="mi">0</span> 
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__eq__()&quot;</span><span class="p">)</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">x_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span>
        <span class="n">x_l</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">noise</span>

        <span class="k">return</span> <span class="n">x_r</span> <span class="o">==</span> <span class="n">x_l</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__pow__()&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RealNumber</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t exponentiate electrical_signal by type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
            <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>
        <span class="k">elif</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span>
            <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> 
        <span class="k">elif</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">noi</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span> <span class="o">**</span> <span class="n">other</span> 
            <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span>
    
<div class="viewcode-block" id="electrical_signal.__call__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.__call__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">],</span> <span class="n">shift</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return a new object with Fast Fourier Transform (FFT) of signal and noise of input object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        domain : {&#39;t&#39;, &#39;w&#39;, &#39;f&#39;}</span>
<span class="sd">            Domain to transform. &#39;t&#39; for time domain (ifft is applied), &#39;w&#39; and &#39;f&#39; for frequency domain (fft is applied).</span>
<span class="sd">        shift : :obj:`bool`, optional</span>
<span class="sd">            If True, apply the ``np.fft.fftshift()`` or ``np.fft.ifftshift`` functions as appropriate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_obj : :obj:`electrical_signal` or :obj:`optical_signal`</span>
<span class="sd">            A new electrical signal object with the result of the transformation.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If ``domain`` is not one of the following values (&#39;t&#39;, &#39;w&#39;, &#39;f&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__call__(domain=&#39;</span><span class="si">%s</span><span class="s2">&#39;, shift=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span> <span class="ow">or</span> <span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
              
        <span class="k">elif</span> <span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`domain` must be one of the following values (&#39;t&#39;, &#39;w&#39;, &#39;f&#39;)&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">shift</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span> <span class="ow">or</span> <span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">noise</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">signal</span> <span class="o">=</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">noise</span> <span class="o">=</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span></div>

    <span class="c1"># properties</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of samples of the electrical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">real</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Real part of the electrical signal (signal + noise).&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">imag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Imaginary part of the electrical signal (signal + noise).&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;imag&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Object type.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Memory size of object in bytes.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sizeof&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sampling frequency of the electrical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;fs()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">fs</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Samples per slot of the electrical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sps()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">sps</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time step of the electrical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;dt&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">dt</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time array for the electrical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>
    
    <span class="c1"># static and private methods</span>
    <span class="nd">@staticmethod</span>  <span class="c1"># can be used without instantiating the class, eg: electrical_signal._prepare_arrays()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_arrays</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;_prepare_arrays()&quot;</span><span class="p">)</span>

        <span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_convert_to_array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;_convert_to_array(</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">))&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">str2array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">signal</span> <span class="o">=</span> <span class="n">_convert_to_array</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">_convert_to_array</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">arrays_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>  <span class="c1"># obtain the most comprehensive type</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arrays_type</span> <span class="o">=</span> <span class="n">dtype</span>

            <span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">arrays_type</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">arrays_type</span><span class="p">)</span> 

            <span class="k">if</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">noise</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`signal` and `noise` must have the same shape, mismatch shapes </span><span class="si">{</span><span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">noise</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;_parse()&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="p">[:]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="n">l_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">l_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">l_min</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">l_min</span> <span class="o">!=</span> <span class="n">l_max</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t operate &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;s with shapes </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">other</span><span class="p">,</span> <span class="n">dtype</span>
    
    <span class="c1"># public methods</span>
<div class="viewcode-block" id="electrical_signal.print"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.print">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print object parameters.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        msg : :obj:`str`, opcional</span>
<span class="sd">            top message to show</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : electrical_signal</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;print()&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="electrical_signal.to_numpy"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.to_numpy">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a NumPy representation of the electrical signal (signal + noise).&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;to_numpy(dtype=</span><span class="si">%s</span><span class="s2">, copy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="electrical_signal.conj"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.conj">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">conj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the complex conjugate of the electrical signal.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            The complex conjugate of the electrical signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;conj()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span></div>

<div class="viewcode-block" id="electrical_signal.sum"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.sum">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the sum of the elements over a given axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : :obj:`int`, optional</span>
<span class="sd">            Axis along which the sum is computed. By default, the sum is computed over the entire array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            New object with signal and noise summed over the specified axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sum(axis=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span> <span class="k">else</span> <span class="n">NULL</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="electrical_signal.w"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.w">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return angular frequency (rad/s) for spectrum representation.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shift : :obj:`bool`, optional</span>
<span class="sd">            If True, apply fftshift().</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`np.ndarray`</span>
<span class="sd">            The angular frequency array for signals simulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span>
        <span class="k">if</span> <span class="n">shift</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span></div>
    
<div class="viewcode-block" id="electrical_signal.f"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.f">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return frequency (Hz) for spectrum representation.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shift : :obj:`bool`, optional</span>
<span class="sd">            If True, apply fftshift().</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`np.ndarray`</span>

<span class="sd">            The frequency array for signals simulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span></div>


<div class="viewcode-block" id="electrical_signal.abs"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.abs">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span><span class="s1">&#39;noise&#39;</span><span class="p">,</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get absolute value of ``signal``, ``noise`` or ``signal+noise``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        of : :obj:`str`, optional</span>
<span class="sd">            Defines from which attribute to obtain the absolute value. If &#39;all&#39;, absolute value of ``signal+noise`` is determined.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out : :obj:`np.ndarray`, (1D or 2D, float)</span>
<span class="sd">            The absolute value of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;abs(of=&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">of</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;`of` must be a string.&#39;</span><span class="p">)</span>
        <span class="n">of</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">of</span> <span class="o">==</span> <span class="s1">&#39;signal&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">of</span> <span class="o">==</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="n">NULL</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">real</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">of</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`of` must be one of the following values (&quot;signal&quot;, &quot;noise&quot;, &quot;all&quot;)&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="electrical_signal.power"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.power">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;dBm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">of</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span><span class="s1">&#39;noise&#39;</span><span class="p">,</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get power of the electrical signal.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        unit : :obj:`str`, optional</span>
<span class="sd">            Defines the unit of power. &#39;W&#39; for Watts, &#39;dBm&#39; for decibels-milliwatts.</span>
<span class="sd">        of : :obj:`str`, optional</span>
<span class="sd">            Defines from which attribute to obtain the power. If &#39;all&#39;, power of ``signal+noise`` is determined.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`float`</span>
<span class="sd">            The power of the electrical signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;power(unit=&#39;</span><span class="si">%s</span><span class="s2">&#39;, of=&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">of</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`of` must be one of the following values (&quot;signal&quot;, &quot;noise&quot;, &quot;all&quot;)&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">of</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">p</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;dbm&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dbm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`unit` must be one of the following values (&quot;W&quot;, &quot;dBm&quot;)&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="electrical_signal.normalize"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.normalize">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;power&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the power-normalized signal</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by : :obj:`str`, optional</span>
<span class="sd">            Defines the normalization method. ``&#39;power&#39;`` for power normalization, ``&#39;amplitude&#39;`` for amplitude normalization.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            The normalized electrical signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;normalize(by=&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:]</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span>
            <span class="n">pw</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">pw</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">elif</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span>
            <span class="n">amp</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">amp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`by` must be one of the following values (&quot;power&quot;, &quot;amplitude&quot;)&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="electrical_signal.phase"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.phase">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get phase of the electrical signal: ``unwrap(angle(signal+noise))``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`np.ndarray`</span>
<span class="sd">            the unwrapped phase of the electrical signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;phase()&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="electrical_signal.filter"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.filter">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply FIR filter of impulse response **h** to the electrical signal: ``np.convolve(signal + noise, h, mode=&#39;same&#39;)``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h : :obj:`np.ndarray`</span>
<span class="sd">            The FIR filter impulse response.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            An electrical signal object with the result of the filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;filter()&quot;</span><span class="p">)</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
            <span class="n">noi</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">)</span> </div>

<div class="viewcode-block" id="electrical_signal.plot"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
             <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> 
             <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">grid</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">hold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span> 
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plot signal in time domain.</span>

<span class="sd">        For electrical_signal: plots the real part of the signal.</span>
<span class="sd">        For optical_signal: plots the intensity/power.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmt : :obj:`str` or :obj:`list`, optional</span>
<span class="sd">            Format style of line. Example ``&#39;b-.&#39;``, Defaults to ``&#39;-&#39;``.</span>
<span class="sd">        n : :obj:`int`, optional</span>
<span class="sd">            Number of samples to plot. Defaults to the length of the signal.</span>
<span class="sd">        xlabel : :obj:`str`, optional</span>
<span class="sd">            X-axis label. Defaults to ``&#39;Time [ns]&#39;``.</span>
<span class="sd">        ylabel : :obj:`str`, optional</span>
<span class="sd">            Y-axis label. Defaults to ``&#39;Amplitude [V]&#39;``</span>
<span class="sd">        grid : :obj:`bool`, optional</span>
<span class="sd">            If show grid. Defaults to ``False``.</span>
<span class="sd">        hold : :obj:`bool`, optional</span>
<span class="sd">            If hold the current plot. Defaults to ``True``.</span>
<span class="sd">        **kwargs : :obj:`dict`</span>
<span class="sd">            Additional keyword arguments compatible with ``matplotlib.pyplot.plot()``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;plot()&quot;</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="mf">1e9</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
        
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span> <span class="k">if</span> <span class="n">ylabel</span> <span class="k">else</span> <span class="s1">&#39;Amplitude [V]&#39;</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span> <span class="k">if</span> <span class="n">xlabel</span> <span class="k">else</span> <span class="s1">&#39;Time [ns]&#39;</span>

        <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hold</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="o">*</span><span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">][::</span><span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">]):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="electrical_signal.psd"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.psd">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">psd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
            <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> 
            <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;both&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> 
            <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">yscale</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;dbm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;dbm&#39;</span><span class="p">,</span> 
            <span class="n">grid</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot Power Spectral Density (PSD) of the electrical/optical signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmt : :obj:`str` or :obj:`list`</span>
<span class="sd">            Format style of line. Example ``&#39;b-.&#39;``. Defaults to ``&#39;-&#39;``.</span>
<span class="sd">        mode : :obj:`str`, optional</span>
<span class="sd">            Polarization mode to show (for optical signals). Defaults to ``&#39;x&#39;``.</span>
<span class="sd">            </span>
<span class="sd">            - ``&#39;x&#39;`` plot polarization x.</span>
<span class="sd">            - ``&#39;y&#39;`` plot polarization y.</span>
<span class="sd">            - ``&#39;both&#39;`` plot both polarizations x and y in the same figure.</span>

<span class="sd">        n : :obj:`int`, optional</span>
<span class="sd">            Number of samples to plot. Defaults to the length of the signal.</span>
<span class="sd">        xlabel : :obj:`str`, optional</span>
<span class="sd">            X-axis label. Defaults to ``&#39;Frequency [GHz]&#39;``.</span>
<span class="sd">        ylabel : :obj:`str`, optional</span>
<span class="sd">            Y-axis label. Defaults to ``&#39;Power [dBm]&#39;`` if ``yscale=&#39;dbm&#39;`` or ``&#39;Power [mW]&#39;`` if ``yscale=&#39;linear&#39;``.</span>
<span class="sd">        yscale : :obj:`str`, {&#39;linear&#39;, &#39;dbm&#39;}, optional</span>
<span class="sd">            Kind of Y-axis plot. Defaults to ``&#39;dbm&#39;``.</span>
<span class="sd">        grid : :obj:`bool`, optional</span>
<span class="sd">            If show grid. Defaults to ``True``.</span>
<span class="sd">        hold : :obj:`bool`, optional</span>
<span class="sd">            If hold the current plot. Defaults to ``True``.</span>
<span class="sd">        **kwargs : :obj:`dict`</span>
<span class="sd">            Additional matplotlib arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        obj:`electrical_signal`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;psd()&quot;</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">signal</span>
        <span class="n">nperseg</span> <span class="o">=</span> <span class="mi">2048</span> <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2048</span> <span class="k">else</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">gv</span><span class="o">.</span><span class="n">fs</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="n">return_onesided</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">psd</span><span class="p">,</span> <span class="n">axes</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">yscale</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="n">psd</span> <span class="o">=</span> <span class="n">psd</span><span class="o">*</span><span class="mf">1e3</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span> <span class="k">if</span> <span class="n">ylabel</span> <span class="k">else</span> <span class="s1">&#39;Power [mW]&#39;</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,)</span>
        <span class="k">elif</span> <span class="n">yscale</span> <span class="o">==</span> <span class="s1">&#39;dbm&#39;</span><span class="p">:</span>
            <span class="n">psd</span> <span class="o">=</span> <span class="n">dbm</span><span class="p">(</span><span class="n">psd</span><span class="p">)</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span> <span class="k">if</span> <span class="n">ylabel</span> <span class="k">else</span> <span class="s1">&#39;Power [dBm]&#39;</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;`yscale` must be one of the following values (&quot;linear&quot;, &quot;dbm&quot;)&#39;</span><span class="p">)</span>
        
        <span class="n">n_pol</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;n_pol&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for single polarization signals, using default value.&#39;</span><span class="p">)</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for single polarization signals, using default value.&#39;</span><span class="p">)</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for single polarization signals, using default value.&#39;</span><span class="p">)</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string or a list of strings for both polarizations signals, using default value.&#39;</span><span class="p">)</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;argument `mode` should be (&quot;x&quot;, &quot;y&quot; or &quot;both&quot;)&#39;</span><span class="p">)</span>    
        
        <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span> <span class="ow">and</span> <span class="n">n_pol</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hold</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span> <span class="k">if</span> <span class="n">xlabel</span> <span class="k">else</span> <span class="s1">&#39;Frequency [GHz]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span> <span class="o">-</span><span class="mf">3.5</span><span class="o">*</span><span class="n">gv</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">gv</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="mf">1e-9</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span> <span class="o">*</span><span class="n">ylim</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; X&#39;</span><span class="p">)</span>
                <span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; Y&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`label` must be a string or a list of strings.&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="electrical_signal.plot_eye"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.plot_eye">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_eye</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_traces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
             <span class="n">N_grid_bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kw</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plots a colored eye diagram, internally calculating color density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_traces : :obj:`int`, optional</span>
<span class="sd">            Maximum number of traces to plot. If ``None``, all available traces</span>
<span class="sd">            will be plotted. Defaults to ``None``.</span>
<span class="sd">        cmap : :obj:`str`, optional</span>
<span class="sd">            Name of the matplotlib colormap. Defaults to ``&#39;jet&#39;``.</span>
<span class="sd">        N_grid_bins : :obj:`int`, optional</span>
<span class="sd">            Number of bins for the density histogram. Defaults to ``200``.</span>
<span class="sd">        grid_sigma : :obj:`float`, optional</span>
<span class="sd">            Sigma for the Gaussian filter applied to the density. Defaults to ``5``.</span>
<span class="sd">        style : Literal[&#39;line&#39;, &#39;dot&#39;, &#39;density&#39;], optional</span>
<span class="sd">            Style of the eye diagram plot:</span>
<span class="sd">            - &#39;line&#39;: Plots traces as lines.</span>
<span class="sd">            - &#39;dot&#39;: Plots traces as dots.</span>
<span class="sd">            - &#39;density&#39;: Plots density map only.</span>
<span class="sd">        ax : :obj:`matplotlib.axes.Axes`, optional</span>
<span class="sd">            Axes object to plot on. If ``None``, creates new figure and axes.</span>
<span class="sd">            Defaults to ``None``.</span>
<span class="sd">        \*\*plot_kw : :obj:`dict`, optional</span>
<span class="sd">            Additional plotting parameters:</span>
<span class="sd">            </span>
<span class="sd">            *Figure parameters (used only if ax is ``None``):*</span>
<span class="sd">            </span>
<span class="sd">            - **figsize** : :obj:`tuple`, default ``(10, 6)``</span>
<span class="sd">            - **dpi** : :obj:`int`, default ``100``</span>
<span class="sd">            </span>
<span class="sd">            *Line collection parameters:*</span>
<span class="sd">            </span>
<span class="sd">            - **linewidth** : :obj:`float`, default ``0.75``</span>
<span class="sd">            - **alpha** : :obj:`float`, default ``0.25``</span>
<span class="sd">            - **capstyle** : :obj:`str`, default ``&#39;round&#39;``</span>
<span class="sd">            - **joinstyle** : :obj:`str`, default ``&#39;round&#39;``</span>
<span class="sd">            </span>
<span class="sd">            *Axes formatting parameters:*</span>
<span class="sd">            </span>
<span class="sd">            - **xlabel** : :obj:`str`, default ``&quot;Time (2-symbol segment)&quot;``</span>
<span class="sd">            - **ylabel** : :obj:`str`, default ``&quot;Amplitude&quot;``</span>
<span class="sd">            - **title** : :obj:`str`, default ``&quot;Eye Diagram ({num_traces} traces)&quot;``</span>
<span class="sd">            - **grid** : bool, default ``True``</span>
<span class="sd">            - **grid_alpha** : :obj:`float`, default ``0.3``</span>
<span class="sd">            - **xlim** : :obj:`tuple`, optional (xmin, xmax)</span>
<span class="sd">            - **ylim** : :obj:`tuple`, optional (ymin, ymax)</span>
<span class="sd">            - **tight_layout** : :obj:`bool`, default ``True``</span>
<span class="sd">            </span>
<span class="sd">            *Display parameters:*</span>

<span class="sd">            - **show** : :obj:`bool`, default ``True`` (whether to call ``plt.show()``)</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`electrical_signal`</span>
<span class="sd">            The same object with the plotted eye diagram.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tic</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;plot_eye()&quot;</span><span class="p">)</span>

        <span class="n">MAX_TRACES</span> <span class="o">=</span> <span class="mi">4096</span>

        <span class="k">if</span> <span class="n">n_traces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_traces</span> <span class="o">=</span> <span class="n">MAX_TRACES</span> <span class="c1"># large number to plot all traces</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_traces</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_traces</span><span class="p">,</span> <span class="n">MAX_TRACES</span><span class="p">)</span>

        <span class="n">eyediagram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">,</span> <span class="n">n_traces</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">N_grid_bins</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">+=</span> <span class="n">toc</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="electrical_signal.grid"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.grid">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add grid to the plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        \*\*kwargs : :obj:`dict`</span>
<span class="sd">            Arbitrary keyword arguments to pass to the function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : :obj:`electrical_signal`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;grid()&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="electrical_signal.legend"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.legend">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add a legend to the plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        \*args : :obj:`iterable`</span>
<span class="sd">            Variable length argument list to pass to the function.</span>
<span class="sd">        \*\*kwargs : :obj:`dict`</span>
<span class="sd">            Arbitrary keyword arguments to pass to the function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : :obj:`electrical_signal`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;legend()&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="electrical_signal.show"><a class="viewcode-back" href="../../types.html#opticomlib.typing.electrical_signal.show">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show plots.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : :obj:`electrical_signal`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;show()&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>











<div class="viewcode-block" id="optical_signal"><a class="viewcode-back" href="../../types.html#opticomlib.typing.optical_signal">[docs]</a><span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent_methods</span>
<span class="k">class</span><span class="w"> </span><span class="nc">optical_signal</span><span class="p">(</span><span class="n">electrical_signal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;**Optical Signal**</span>
<span class="sd">    </span>
<span class="sd">    Bases: :obj:`electrical_signal`</span>

<span class="sd">    This class provides methods and attributes to work with optical signals. Attributes and some methods are inherited from the :obj:`electrical_signal` class.</span>

<span class="sd">    .. rubric:: Attributes</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        ~optical_signal.signal</span>
<span class="sd">        ~optical_signal.noise</span>
<span class="sd">        ~optical_signal.execution_time</span>

<span class="sd">    .. rubric:: Methods</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        __init__</span>
<span class="sd">        plot</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="optical_signal.__init__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.optical_signal.__init__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">signal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">,</span> 
                 <span class="n">noise</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">,</span> 
                 <span class="n">n_pol</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initialize the optical signal object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        signal : :obj:`str` or array_like (1D, 2D) or scalar</span>
<span class="sd">            The signal values.</span>
<span class="sd">        noise : :obj:`str` or array_like (1D, 2D) or scalar, optional</span>
<span class="sd">            The noise values, default is ``NULL``.</span>
<span class="sd">        n_pol : :obj:`int`, optional</span>
<span class="sd">            Number of polarizations. Defaults to ``1``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">optical_signal</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.__init__(n_pol=</span><span class="si">%s</span><span class="s2">, dtype=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">n_pol</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="p">(</span><span class="n">electrical_signal</span><span class="p">,</span> <span class="n">optical_signal</span><span class="p">)):</span>
                <span class="n">sig</span><span class="p">,</span> <span class="n">noi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">noise</span>
                <span class="k">if</span> <span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">noi_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_arrays</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span> <span class="o">+</span> <span class="n">noi_</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sig</span><span class="p">,</span> <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_arrays</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sig</span><span class="o">.</span><span class="n">size</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal must be a scalar, 1D or 2D array for optical_signal, invalid shape </span><span class="si">{</span><span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_pol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_pol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n_pol must be either 1 or 2&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_pol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                    <span class="n">n_pol</span><span class="o">=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">sig</span><span class="p">],</span> <span class="p">[</span><span class="n">sig</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">noi</span><span class="p">],</span> <span class="p">[</span><span class="n">noi</span><span class="p">]])</span>
            
            <span class="k">elif</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_pol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
                    <span class="n">n_pol</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sig</span><span class="p">,</span> <span class="n">sig</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">noi</span><span class="p">,</span> <span class="n">noi</span><span class="p">])</span>
            
            <span class="k">elif</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_pol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_pol</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">noi</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                    <span class="n">n_pol</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
            <span class="k">elif</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_pol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_pol</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">n_pol</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">noi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                        <span class="n">noi</span> <span class="o">=</span> <span class="n">noi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">=</span> <span class="n">n_pol</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>  </div>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__repr__()&quot;</span><span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;optical_signal(</span><span class="si">{</span><span class="n">signal</span><span class="si">}</span><span class="s1">)&#39;</span>
        
        <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">22</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">22</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;optical_signal(signal=</span><span class="si">{</span><span class="n">signal</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;noise=</span><span class="si">{</span><span class="n">noise</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__str__()&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">    &#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39;-&#39;</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39; &#39;</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">tab</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">tab</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        
        <span class="c1"># Get power values</span>
        <span class="n">pw_sig_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">)</span>
        <span class="n">pw_sig_dbm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;dbm&#39;</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">)</span>
        <span class="n">pw_noise_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">)</span>
        <span class="n">pw_noise_dbm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;dbm&#39;</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">)</span>
        <span class="n">pw_all_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
        <span class="n">pw_all_dbm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;dbm&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>

        <span class="c1"># Format power strings</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">):</span>
            <span class="n">pow_sig_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_sig_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span>
            <span class="n">pow_noise_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_noise_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_noise_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span>
            <span class="n">pow_all_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_all_w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_all_dbm</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For multi-polarization</span>
            <span class="n">pow_sig_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;Pol</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_sig_dbm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pw_sig_w</span><span class="p">))])</span>
            <span class="n">pow_noise_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;Pol</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_noise_w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_noise_dbm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pw_noise_w</span><span class="p">))])</span>
            <span class="n">pow_all_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;Pol</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="n">pw_all_w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pw_all_dbm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dBm)&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pw_all_w</span><span class="p">))])</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;signal:     </span><span class="si">{</span><span class="n">signal</span><span class="si">}</span><span class="s1"> (shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;noise:      </span><span class="si">{</span><span class="n">noise</span><span class="si">}</span><span class="s1"> (shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;pow_signal: </span><span class="si">{</span><span class="n">pow_sig_str</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;pow_noise:  </span><span class="si">{</span><span class="n">pow_noise_str</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;pow_total:  </span><span class="si">{</span><span class="n">pow_all_str</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;elem_type:  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;mem_size:   </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sizeof</span><span class="si">}</span><span class="s1"> bytes</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> \
            <span class="sa">f</span><span class="s1">&#39;time:       </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">msg</span>

    
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span> 
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__getitem__(</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;Too many indices for optical_signal object.&#39;</span><span class="p">)</span>
            <span class="n">pol_idx</span><span class="p">,</span> <span class="n">time_idx</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">pol_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;Optical signal has only one polarization (index 0).&#39;</span><span class="p">)</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">pol_idx</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">pol_idx</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">sig</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">,</span> <span class="n">n_pol</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span><span class="o">!=</span><span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[:,</span> <span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[:,</span> <span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">,</span> <span class="n">n_pol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">sig</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="p">:]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
                    <span class="n">noi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>   
                    <span class="n">noi</span> <span class="o">=</span> <span class="n">NULL</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">noi</span><span class="p">,</span> <span class="n">n_pol</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">ndim</span><span class="o">!=</span><span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span><span class="p">)</span>            
            
    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> 
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The &gt; operator is not implemented for optical_signal objects.&#39;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The &lt; operator is not implemented for optical_signal objects.&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of samples of one polarization of the optical signal.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>

<div class="viewcode-block" id="optical_signal.plot"><a class="viewcode-back" href="../../types.html#opticomlib.typing.optical_signal.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
             <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> 
             <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;power&#39;</span><span class="p">,</span> 
             <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
             <span class="n">grid</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">hold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span> 
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plot signal in time domain.</span>

<span class="sd">        For optical_signal: plots the intensity/power or field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmt : :obj:`str` or :obj:`list`, optional</span>
<span class="sd">            Format style of line. Example ``&#39;b-.&#39;``, Defaults to ``&#39;-&#39;``.</span>
<span class="sd">        mode : :obj:`str`, optional</span>
<span class="sd">            Plot mode. ``&#39;field&#39;``, ``&#39;power&#39;`` (default).</span>

<span class="sd">            - ``&#39;field&#39;`` plot real and imaginary parts of the field one-polarization.</span>
<span class="sd">            - ``&#39;power&#39;`` plot power/intensity (one or two polarizations).</span>

<span class="sd">        n : :obj:`int`, optional</span>
<span class="sd">            Number of samples to plot. Defaults to the length of the signal.</span>
<span class="sd">        xlabel : :obj:`str`, optional</span>
<span class="sd">            X-axis label. Defaults to ``&#39;Time [ns]&#39;``.</span>
<span class="sd">        ylabel : :obj:`str`, optional</span>
<span class="sd">            Y-axis label. Defaults to ``&#39;Power [mW]&#39;`` for power, ``&#39;Field [W**0.5]&#39;`` for field.</span>
<span class="sd">        grid : :obj:`bool`, optional</span>
<span class="sd">            If show grid. Defaults to ``False``.</span>
<span class="sd">        hold : :obj:`bool`, optional</span>
<span class="sd">            If hold the current plot. Defaults to ``True``.</span>
<span class="sd">        **kwargs : :obj:`dict`</span>
<span class="sd">            Additional keyword arguments compatible with ``matplotlib.pyplot.plot()``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : optical_signal</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;plot()&quot;</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="mf">1e9</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hold</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span> <span class="k">if</span> <span class="n">xlabel</span> <span class="k">else</span> <span class="s1">&#39;Time [ns]&#39;</span>
        
        <span class="c1"># Optical signal: plot intensity or field</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1e3</span>  <span class="c1"># mW</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for single polarization signals, using default value.&#39;</span><span class="p">)</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for multi-polarization signals, using default value.&#39;</span><span class="p">)</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">args0</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>  <span class="c1"># total power</span>
                <span class="n">args1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>  <span class="c1"># total power</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pol X&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; Pol X&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pol Y&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; Pol Y&#39;</span><span class="p">)</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span>
                
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span> <span class="k">if</span> <span class="n">ylabel</span> <span class="k">else</span> <span class="s1">&#39;Power [mW]&#39;</span>
    
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;field&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">n_pol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`field` mode is only supported for single polarization signals.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;`fmt` must be a string for field mode, using default value.&#39;</span><span class="p">)</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39;Real&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39;Imag&#39;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span> <span class="k">if</span> <span class="n">ylabel</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;Field [$\sqrt</span><span class="si">{W}</span><span class="s1">$]&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`mode` must be one of (&quot;power&quot;, &quot;field&quot;) for optical signals.&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="o">*</span><span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">][::</span><span class="n">gv</span><span class="o">.</span><span class="n">sps</span><span class="p">]):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>












<span class="k">class</span><span class="w"> </span><span class="nc">EyeShowOptions</span><span class="p">():</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
            <span class="n">averages</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">threshold</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">cross_points</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">legends</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">t_opt</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">histogram</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">all_none</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">averages</span> <span class="o">=</span> <span class="n">averages</span> <span class="k">if</span> <span class="n">averages</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span> <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cross_points</span> <span class="o">=</span> <span class="n">cross_points</span> <span class="k">if</span> <span class="n">cross_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="n">legends</span> <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_opt</span> <span class="o">=</span> <span class="n">t_opt</span> <span class="k">if</span> <span class="n">t_opt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">histogram</span> <span class="o">=</span> <span class="n">histogram</span> <span class="k">if</span> <span class="n">histogram</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_none</span>











<div class="viewcode-block" id="eye"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye">[docs]</a><span class="nd">@logger</span><span class="o">.</span><span class="n">auto_indent_methods</span>
<span class="k">class</span><span class="w"> </span><span class="nc">eye</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;**Eye Diagram Parameters**.</span>

<span class="sd">    This object contains the parameters of an eye diagram and methods to plot it.</span>

<span class="sd">    .. rubric:: Methods</span>
<span class="sd">    .. autosummary::</span>

<span class="sd">        __init__</span>
<span class="sd">        __str__</span>
<span class="sd">        print</span>
<span class="sd">        plot</span>
<span class="sd">        show</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    t : :obj:`np.ndarray`</span>
<span class="sd">        The time values resampled. Shape (Nx1).</span>
<span class="sd">    y : :obj:`np.ndarray`</span>
<span class="sd">        The signal values resampled. Shape (Nx1).</span>
<span class="sd">    dt : :obj:`float`</span>
<span class="sd">        Time between samples.</span>
<span class="sd">    sps : :obj:`int`</span>
<span class="sd">        Samples per slot.</span>
<span class="sd">    t_left : :obj:`float`</span>
<span class="sd">        Cross time of left edge.</span>
<span class="sd">    t_right : :obj:`float`</span>
<span class="sd">        Cross time of right edge.</span>
<span class="sd">    t_opt : :obj:`float`</span>
<span class="sd">        Optimal time decision.</span>
<span class="sd">    t_dist : :obj:`float`</span>
<span class="sd">        Time between slots.</span>
<span class="sd">    t_span0 : :obj:`float`</span>
<span class="sd">        t_opt - t_dist*5%.</span>
<span class="sd">    t_span1 : :obj:`float`</span>
<span class="sd">        t_opt + t_dist*5%.</span>
<span class="sd">    y_top : :obj:`np.ndarray`</span>
<span class="sd">        Samples of signal above threshold and within t_span0 and t_apan1.</span>
<span class="sd">    y_bot : :obj:`np.ndarray`</span>
<span class="sd">        Samples of signal below threshold and within t_span0 and t_apan1.</span>
<span class="sd">    mu0 : :obj:`float`</span>
<span class="sd">        Mean of y_bot.</span>
<span class="sd">    mu1 : :obj:`float`</span>
<span class="sd">        Mean of y_top.</span>
<span class="sd">    s0 : :obj:`float`</span>
<span class="sd">        Standard deviation of y_bot.</span>
<span class="sd">    s1 : :obj:`float`</span>
<span class="sd">        Standard deviation of y_top.</span>
<span class="sd">    er : :obj:`float`</span>
<span class="sd">        Extinction ratio.</span>
<span class="sd">    eye_h : :obj:`float`</span>
<span class="sd">        Eye height.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="eye.__init__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye.__init__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; Initialize the eye diagram object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        \*\*kwargs : :obj:`dict`, optional</span>
<span class="sd">            Dictionary with the eye diagram parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.__init__()&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty</span> <span class="o">=</span> <span class="kc">True</span></div>
        
<div class="viewcode-block" id="eye.__str__"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye.__str__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a formatted string with the eye diagram data.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__str__()&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Empty eye diagram object.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">    &#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="s1">&#39;*&#39;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39;-&#39;</span>

        <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="se">\n</span><span class="s1"> &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;execution_time&#39;</span><span class="p">])</span>
        
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> time  :  </span><span class="si">{</span><span class="n">si</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">msg</span></div>
    
<div class="viewcode-block" id="eye.print"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye.print">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print object parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        msg : :obj:`str`, optional</span>
<span class="sd">            Top message to show.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self: :obj:`eye`</span>
<span class="sd">            Same object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;print()&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="eye.plot"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
             <span class="n">show_options</span><span class="p">:</span> <span class="n">EyeShowOptions</span><span class="o">=</span><span class="n">EyeShowOptions</span><span class="p">(),</span>
             <span class="n">hlines</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">vlines</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[],</span> 
             <span class="n">style</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;dark&#39;</span><span class="p">,</span> <span class="s1">&#39;light&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;dark&#39;</span><span class="p">,</span> 
             <span class="n">cmap</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="s1">&#39;inferno&#39;</span><span class="p">,</span> <span class="s1">&#39;cividis&#39;</span><span class="p">,</span> <span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="s1">&#39;winter&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;winter&#39;</span><span class="p">,</span>
             <span class="n">smooth</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">savefig</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plot eye diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        show_options : :obj:`typing.EyeShowOptions`, optional</span>
<span class="sd">            Options to show in the plot. Default show all.</span>
<span class="sd">        hlines : :obj:`list`, optional</span>
<span class="sd">            A list of time values in which hlines will be set.</span>
<span class="sd">        vlines : :obj:`list`, optional</span>
<span class="sd">            A list of voltage values in which vlines will be set.</span>
<span class="sd">        style : :obj:`str`, optional</span>
<span class="sd">            Plot style. &#39;dark&#39; or &#39;light&#39;.</span>
<span class="sd">        cmap : :obj:`str`, optional</span>
<span class="sd">            Colormap to plot.</span>
<span class="sd">        title : :obj:`str`, optional</span>
<span class="sd">            Title of plot.</span>
<span class="sd">        savefig : :obj:`str`, optional</span>
<span class="sd">            Name of the file to save the plot. If None, the plot is not saved.</span>
<span class="sd">            Input just the name of the file without extension (extension is .png by default).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self: :obj:`eye`</span>
<span class="sd">            Same object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;plot()&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Empty eye diagram object.&#39;</span><span class="p">)</span>

        <span class="c1">## SETTINGS</span>
        
        <span class="c1"># Determine style context for temporary style changes</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;dark&#39;</span><span class="p">:</span>
            <span class="n">style_context</span> <span class="o">=</span> <span class="s1">&#39;dark_background&#39;</span>
            <span class="n">t_opt_color</span> <span class="o">=</span> <span class="s1">&#39;#60FF86&#39;</span>
            <span class="n">means_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
            <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>
            <span class="n">style_context</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
            <span class="n">t_opt_color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="c1">#&#39;#229954&#39;</span>
            <span class="n">means_color</span> <span class="o">=</span> <span class="s1">&#39;#5A5A5A&#39;</span>
            <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The `style` argument must be one of the following values (&#39;dark&#39;, &#39;light&#39;)&quot;</span><span class="p">)</span>
        
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>

        <span class="c1"># Use style context manager only when creating new axes to avoid global state pollution</span>
        <span class="c1"># When ax is provided by caller, respect their style settings</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">nullcontext</span>
        <span class="n">style_mgr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style_context</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">nullcontext</span><span class="p">()</span>
        
        <span class="k">with</span> <span class="n">style_mgr</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  
                                                        <span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">},</span>
                                                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax</span><span class="p">]</span>
                
            <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Eye diagram </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">dt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu0</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">s0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu1</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Amplitude [V]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Time [$t/T_</span><span class="si">{slot}</span><span class="s1">$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">t_opt</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_opt</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">t_opt_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_span0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">t_opt_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_span1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">t_opt_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>

            <span class="c1"># crossing points</span>
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">cross_points</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_right</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_left</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">t_left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_right</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_right</span><span class="p">],</span> <span class="s1">&#39;xr&#39;</span><span class="p">)</span>

            <span class="c1"># threshold</span>
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;th&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">legends</span><span class="p">:</span>
                        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            
            <span class="c1"># horizontal lines</span>
            <span class="k">for</span> <span class="n">hl</span> <span class="ow">in</span> <span class="n">hlines</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">hl</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">hl</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            
            <span class="c1"># vertical lines</span>
            <span class="k">for</span> <span class="n">vl</span> <span class="ow">in</span> <span class="n">vlines</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">vl</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span> <span class="p">(</span><span class="n">vl</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            
            <span class="c1"># legend</span>
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">legends</span><span class="p">:</span> 
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{opt}</span><span class="s1">$&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
            
            <span class="c1"># means</span>
            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">averages</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">means_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">means_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">means_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu_1$&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">means_color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu_0$&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">legends</span><span class="p">:</span>
                        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


            <span class="c1">## ADD PLOTS</span>
            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="o">//</span><span class="mi">2</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="o">//</span><span class="mi">2</span> <span class="p">:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># shift signal to center</span>
            <span class="n">t_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">]</span>

            <span class="n">N</span> <span class="o">=</span> <span class="mi">350</span>  <span class="c1"># number of bins</span>
            <span class="n">heatmap</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
            <span class="n">heatmap_smooth</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xedges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xedges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yedges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yedges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">heatmap</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">heatmap</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">alpha_values</span> <span class="o">=</span> <span class="n">expit</span><span class="p">((</span><span class="n">heatmap_smooth</span> <span class="o">-</span> <span class="p">(</span><span class="n">vmin</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="mf">0.8</span>

                <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
                    <span class="n">heatmap_smooth</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
                    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> 
                    <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> 
                    <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_values</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bicubic&#39;</span><span class="p">,</span>
                    <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># fig.colorbar(img, ax=ax[0])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># ax[0].hexbin( # plot eye</span>
                <span class="c1">#     x = t_, </span>
                <span class="c1">#     y = y_, </span>
                <span class="c1">#     gridsize=500, </span>
                <span class="c1">#     bins=&#39;log&#39;,</span>
                <span class="c1">#     alpha=0.7, </span>
                <span class="c1">#     cmap=cmap </span>
                <span class="c1"># )</span>
                <span class="n">t_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_</span> <span class="o">-</span> <span class="n">t_</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">t_</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                <span class="n">y_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_</span> <span class="o">-</span> <span class="n">y_</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">y_</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">y_</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

                <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">((</span><span class="n">t_norm</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">iy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">((</span><span class="n">y_norm</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

                <span class="n">color_values</span> <span class="o">=</span> <span class="n">heatmap_smooth</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="n">iy</span><span class="p">]</span>
                <span class="n">color_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">color_values</span> <span class="o">-</span> <span class="n">color_values</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">color_values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">color_values</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

                <span class="n">t</span> <span class="o">=</span> <span class="n">t_</span><span class="p">[:</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">]</span>

                <span class="n">n_traces</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>

                <span class="n">Y_reshaped</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[:</span><span class="n">n_traces</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>
                <span class="n">color_values_reshaped</span> <span class="o">=</span> <span class="n">color_values</span><span class="p">[:</span><span class="n">n_traces</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sps</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">color_values_reshaped</span><span class="p">,</span> <span class="n">Y_reshaped</span><span class="p">):</span>
                    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                    <span class="c1"># Asignar color a cada segmento según la grilla</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)(</span><span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                    <span class="n">lc</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">show_options</span><span class="o">.</span><span class="n">histogram</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heatmap_smooth</span><span class="p">[</span><span class="mi">170</span><span class="p">:</span><span class="mi">180</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">350</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">t_opt_color</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>  <span class="c1"># plot vertical histogram </span>
                        <span class="n">y_</span><span class="p">[(</span><span class="n">t_</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">t_opt</span><span class="o">-</span><span class="mf">0.05</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t_dist</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">t_opt</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t_dist</span><span class="p">)],</span> 
                        <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> 
                        <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                        <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> 
                        <span class="n">color</span> <span class="o">=</span> <span class="n">t_opt_color</span><span class="p">,</span> 
                        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
                        <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="n">savefig</span><span class="p">:</span> 
                <span class="k">if</span> <span class="n">savefig</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="eye.show"><a class="viewcode-back" href="../../types.html#opticomlib.typing.eye.show">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show plot</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : :obj:`eye`</span>
<span class="sd">            The same object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;show()&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ing. Armando P. Romeu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>